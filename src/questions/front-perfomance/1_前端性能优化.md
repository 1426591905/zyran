# 前端性能优化

## 回流重绘

#### 类型：`中级`

#### 级别：`W1`、`W2`、`W3`、`W4`、`W5`、`W6`

#### 解答（5 分）

- **1：** 回流：浏览器渲染页面之前需要对结构进行布局计算
- **1：** 重绘：将已经计算好布局的容器绘制出来

- **1：** 触发回流：页面上有容器的几何属性发生变更
- **1：** 触发重绘：容器非几何属性变更 （字体，颜色）

- **1：** 回流必定重绘，重绘不一定回流

## 前端性能指标有哪些？

#### 类型：`中级`

#### 级别：`W3`、`W4`、`W5`、`W6`

#### 解答（11 分）

- **1：** FCP：全称为 First Contentful Paint，即首次内容绘制，表示页面绘制其第一个非白色元素（如文本、图像、非空白 canvas 或 SVG）所需的时间。
- **1：** LCP：全称为 Largest Contentful Paint，即最大内容绘制，用于记录视窗内最大的元素绘制的时间，这个时间会随着页面渲染变化而变化，因为页面中的最大元素在渲染过程中可能会发生改变，该指标会在用户第一次交互后停止记录。
- **1：** TTFB：全称为 Time to First Byte，即首字节时间，表示从点击网页到接收到第一个字节的时间。
- **1：** TBT：全称为 Total Blocking Time，即总阻塞时间，用于衡量的是长任务对主线程的阻塞时间总和。即从首次内容绘制（FCP）到页面达到可交互时间（TTI）期间，主线程因运行长任务而被阻塞的总时间，因此，TBT 会对首次输入延迟有很大影响。长任务是指那些执行时间超过 50 毫秒的 JavaScript 任务，因为它们可能会阻塞页面的渲染和响应，从而影响用户体验。
- **1：** FMP：全称为 First Meaningful Paint，即首次有效渲染。它衡量的是从用户开始加载页面到浏览器首次渲染出对用户来说有意义的内容（如文本、图片、按钮等可交互元素）所花费的时间。
- **1：** FP：全称为 First Paint，即首次绘制，表示浏览器首次将像素渲染到屏幕上的时间点。在性能统计指标中，从用户开始访问 Web 页面的时间点到FP的时间点这段时间可以被视为白屏时间，即用户看到的都是没有任何内容的白色屏幕。FP 指标反映了页面的白屏时间，白屏时间的长短直接影响了用户的体验和满意度。
- **1：** SI：全称为 Speed Index，即速度指数，用于衡量页面渲染用户可见内容迅速程度。Speed Index 并不是一个具体的时间点，而是一个综合性指标。它表示页面从加载开始到页面内容基本可见的过程中，用户感受到的加载速度。该指标是基于视频捕获的可视进度或从绘制事件的可视进展来计算。
- **1：** CLS：全称为 Cumulative Layout Shift，即累积布局偏移，用于衡量一个页面在加载过程中，由于内容的加载和渲染，导致页面布局发生多次变化的情况。具体来说，CLS 指标衡量的是页面中可见元素在加载过程中由于内容加载而发生的位置偏移。这些元素可能因为图片、广告、视频等资源的加载而发生移动。如果一个页面的元素在加载过程中频繁移动，那么这个页面的 CLS 值就会比较高，这通常不是一个好的用户体验。
- **1：** INP：全称为 Interaction to Next Paint，即交互到下一次绘制，用来衡量用户与网页交互后，浏览器完成下一次屏幕绘制所需的时间。这个指标主要关注的是用户交互（如点击、触摸、键盘输入等）之后，页面响应并渲染新内容的速度。
- **1：** FID：全称为 First Input Delay，即首次输入延迟，是衡量网页性能的一个重要指标，它反映了用户在页面加载过程中首次与页面交互时的体验。FID 特别关注用户首次点击按钮、链接、输入字段等可交互元素时，页面响应这些交互所需的时间。
- **1：** TTI：全称为 Time To Interactive，即可交互时间，用于评估页面从开始加载到用户可以顺畅地与之交互的时间点。TTI 特别关注页面的响应性和交互性，它试图捕捉用户能够开始与页面进行流畅交互的瞬间。

## Core Web Vitals指的是什么？

#### 类型：`中级`

#### 级别：`W3`、`W4`、`W5`、`W6`

#### 解答（2 分）

- **1：** Core Web Vitals 是一组由Google推出的关键用户体验指标，旨在帮助开发人员评估和优化网站的性能。这些指标主要关注三个方面：加载性能、交互性能和视觉稳定性。

 >Core Web Vitals 包含了三个指标：INP、LCP、CLS

## 性能测量工具有哪些？

#### 类型：`中级`

#### 级别：`W3`、`W4`、`W5`、`W6`

#### 解答（6 分）

- **2：** 可以借助 Gooogle 开源的 web-vitals 库来测量一些性能指标：

```javascript
import {onCLS, onINP, onLCP, onFCP, onFID, onTTFB} from 'web-vitals';

onCLS(console.log);
onINP(console.log);
onLCP(console.log);
onFCP(console.log);
onFID(console.log);
onTTFB(console.log);
```

- **2：** 使用 Google 提供免费的 PageSpeed Insights (PSI) 工具来测试网站的性能：  
![alt text](/public/images/PSI.png)

- **2：** 使用 Chrome Devtools 的 Lighthouse 选项卡测试性能指标：
![alt text](/public/images/Lighthouse.png)